// i18n/I18nProvider.tsx
import AsyncStorage from "@react-native-async-storage/async-storage";
import React, {
  createContext,
  useContext,
  useEffect,
  useMemo,
  useState,
} from "react";

export type SupportedLang = "vi" | "en";

const translations: Record<SupportedLang, Record<string, string>> = {
  vi: {
    chatboxAI: "ChatboxAI",
    manualTransaction: "Táº¡o giao dá»‹ch thá»§ cÃ´ng",
    // General
    language: "NgÃ´n ngá»¯",
    accountSettings: "CÃ i Ä‘áº·t tÃ i khoáº£n",
    walletAndCategories: "VÃ­ & Danh má»¥c",
    walletAndCategories_desc: "Danh má»¥c, má»Ÿ khoÃ¡ sinh tráº¯c há»c",
    accountSettings_desc: "NgÃ´n ngá»¯, Xuáº¥t/Nháº­p CSV",
    home: "Trang chá»§",
    transactions: "Giao dá»‹ch",
    budget: "NgÃ¢n sÃ¡ch",
    setting: "CÃ i Ä‘áº·t",
    exportImportCSV: "Xuáº¥t / Nháº­p CSV",
    exportData: "Xuáº¥t dá»¯ liá»‡u",
    importData: "Nháº­p dá»¯ liá»‡u",
    exportCSVFile: "Xuáº¥t file CSV",
    importCSVFile: "Nháº­p file CSV",
    exportDesc:
      "Xuáº¥t táº¥t cáº£ giao dá»‹ch ra file CSV Ä‘á»ƒ sao lÆ°u hoáº·c phÃ¢n tÃ­ch dá»¯ liá»‡u",
    importDesc:
      "Nháº­p giao dá»‹ch tá»« file CSV. File pháº£i cÃ³ Ä‘Ãºng Ä‘á»‹nh dáº¡ng: ID, Sá»‘ tiá»n, Loáº¡i, Danh má»¥c, TÃ i khoáº£n, Ghi chÃº, NgÃ y",
    warning: "LÆ°u Ã½",
    warningImport:
      "Nháº­p dá»¯ liá»‡u sáº½ thÃªm giao dá»‹ch má»›i vÃ o cÆ¡ sá»Ÿ dá»¯ liá»‡u hiá»‡n táº¡i, khÃ´ng ghi Ä‘Ã¨ dá»¯ liá»‡u cÅ©.",
    success: "ThÃ nh cÃ´ng",
    error: "Lá»—i",
    exportSuccess: "ÄÃ£ xuáº¥t {count} giao dá»‹ch",
    exportFail: "KhÃ´ng thá»ƒ xuáº¥t file CSV",
    shareFail: "KhÃ´ng thá»ƒ chia sáº» file trÃªn thiáº¿t bá»‹ nÃ y",
    importFeaturePending:
      "TÃ­nh nÄƒng nháº­p CSV sáº½ Ä‘Æ°á»£c cáº­p nháº­t trong phiÃªn báº£n tiáº¿p theo",
    selectLanguage: "Chá»n ngÃ´n ngá»¯",
    infoLanguage: "Thay Ä‘á»•i ngÃ´n ngá»¯ Ã¡p dá»¥ng ngay láº­p tá»©c",
    vietnamese: "Tiáº¿ng Viá»‡t",
    english: "Tiáº¿ng Anh",
    // Notifications
    notifications: "ThÃ´ng bÃ¡o",
    smartNotifications: "ThÃ´ng bÃ¡o thÃ´ng minh",
    smartNotificationsDesc: "Cáº¥u hÃ¬nh nháº¯c nhá»Ÿ vÃ  cáº£nh bÃ¡o tá»± Ä‘á»™ng",
    noNotifications: "ChÆ°a cÃ³ thÃ´ng bÃ¡o",
    noNotificationsDesc: "CÃ¡c thÃ´ng bÃ¡o sáº½ xuáº¥t hiá»‡n á»Ÿ Ä‘Ã¢y",
    // Profile & Settings
    profile: "Há»“ sÆ¡",
    notLoggedIn: "ChÆ°a Ä‘Äƒng nháº­p",
    loginNow: "ÄÄƒng nháº­p ngay",
    viewProfile: "Xem há»“ sÆ¡",
    logout: "ÄÄƒng xuáº¥t",
    logoutConfirm: "Báº¡n cÃ³ cháº¯c muá»‘n Ä‘Äƒng xuáº¥t?",
    // Theme
    appearance: "Giao diá»‡n",
    followSystem: "Theo há»‡ thá»‘ng (khuyáº¿n nghá»‹)",
    lightMode: "SÃ¡ng",
    darkMode: "Tá»‘i",
    // Chatbox
    back: "Quay láº¡i",
    chatWelcome: "Xin chÃ o!ðŸ‘‹ HÃ£y báº¯t Ä‘áº§u thÃªm giao dá»‹ch cá»§a báº¡n táº¡i Ä‘Ã¢y nhÃ©!",
    askAmount: "Báº¡n cho mÃ¬nh biáº¿t sá»‘ tiá»n cá»¥ thá»ƒ nhÃ© ðŸ’¬",
    recorded: "ÄÃ£ ghi nháº­n:",
    expense: "Chi phÃ­",
    income: "Thu nháº­p",
    send: "Gá»­i",
    inputPlaceholder: "vÃ­ dá»¥: trÃ  sá»¯a 60k Â· lÆ°Æ¡ng thÃ¡ng 10 10trâ€¦",
    edit: "Sá»­a",
    delete: "XÃ³a",
    confirmDelete: "XÃ¡c nháº­n xÃ³a",
    confirmDeleteMsg: "Báº¡n cháº¯c cháº¯n muá»‘n xÃ³a giao dá»‹ch nÃ y?",
    cancel: "Há»§y",
    editTransaction: "Chá»‰nh sá»­a giao dá»‹ch",
    amount: "Sá»‘ tiá»n",
    note: "Ghi chÃº",
    category: "Danh má»¥c",
    saveChanges: "LÆ°u thay Ä‘á»•i",
    // Add Transaction
    addTransaction: "ThÃªm giao dá»‹ch",
    expenditure: "Chi tiÃªu",
    revenue: "Thu nháº­p",
    time: "Thá»i gian",
    enterAmount: "Nháº­p sá»‘ tiá»n",
    enterNotes: "Nháº­p ghi chÃº",
    selectCategory: "Chá»n danh má»¥c",
    save: "LÆ°u",
    editCategory: "Sá»­a",
    today: "HÃ´m nay",
    yesterday: "HÃ´m qua",
    thisWeek: "Tuáº§n nÃ y",
    lastWeek: "Tuáº§n trÆ°á»›c",
    thisMonth: "ThÃ¡ng nÃ y",
    lastMonth: "ThÃ¡ng trÆ°á»›c",
    customRange: "TÃ¹y chá»‰nh",
    // Wallet & Categories
    walletSettings: "VÃ­ & danh má»¥c",
    walletName: "TÃªn vÃ­",
    currency: "Tiá»n tá»‡",
    selectCurrency: "Chá»n tiá»n tá»‡",
    openingBalance: "Sá»‘ dÆ° ban Ä‘áº§u",
    manageCategories: "Quáº£n lÃ½ danh má»¥c",
    biometricUnlock: "Má»Ÿ khoÃ¡ báº±ng {type}",
    biometricUnlockDesc: "YÃªu cáº§u xÃ¡c thá»±c khi á»©ng dá»¥ng",
    biometricRegister: "ÄÄƒng kÃ½ {type} Ä‘á»ƒ báº£o vá»‡ vÃ­ vÃ  danh má»¥c",
    biometricSuccess: "{type} Ä‘Ã£ Ä‘Æ°á»£c kÃ­ch hoáº¡t",
    biometricFailed: "KhÃ´ng thÃ nh cÃ´ng",
    biometricFailedDesc: "Vui lÃ²ng xÃ¡c thá»±c Ä‘á»ƒ báº­t tÃ­nh nÄƒng nÃ y",
    deleteWallet: "XÃ³a vÃ­",
    cash: "Tiá»n máº·t",
    // Categories
    categories: "Danh má»¥c",
    addCategory: "ThÃªm danh má»¥c",
    editCategoryTitle: "Sá»­a danh má»¥c",
    categoryName: "TÃªn danh má»¥c",
    categoryIcon: "Biá»ƒu tÆ°á»£ng",
    categoryColor: "MÃ u sáº¯c",
    deleteCategory: "XÃ³a danh má»¥c",
    confirmDeleteCategory: 'XÃ³a danh má»¥c "{name}"?',
    predefinedColors: "MÃ u cÃ³ sáºµn",
    customColor: "Chá»n mÃ u tÃ¹y chá»‰nh",
    showMore: "Xem thÃªm",
    showLess: "Thu gá»n",
    colorPickerUnavailable: "TrÃ¬nh chá»n mÃ u khÃ´ng kháº£ dá»¥ng",
    selectedColor: "MÃ u Ä‘Ã£ chá»n",
    applyColor: "Ãp dá»¥ng mÃ u nÃ y",
    enterCategoryName: "Vui lÃ²ng nháº­p tÃªn danh má»¥c",
    cannotSaveCategory: "KhÃ´ng thá»ƒ lÆ°u danh má»¥c",
    cannotDeleteCategory: "KhÃ´ng thá»ƒ xÃ³a danh má»¥c",

    // Notification settings
    notificationSettings: "CÃ i Ä‘áº·t thÃ´ng bÃ¡o",

    dailyReminder: "Nháº¯c nhá»Ÿ hÃ ng ngÃ y",
    enableReminder: "Báº­t nháº¯c nhá»Ÿ",
    reminderDesc: "Nháº¯c ghi chi tiÃªu cuá»‘i ngÃ y",
    reminderTime: "Thá»i gian nháº¯c",
    reminderTimeDesc: "Chá»n giá» nháº­n thÃ´ng bÃ¡o má»—i ngÃ y",
    inactivityWarning: "Cáº£nh bÃ¡o khÃ´ng hoáº¡t Ä‘á»™ng",
    enableWarning: "Báº­t cáº£nh bÃ¡o",
    inactivityWarningDesc: "Nháº¯c khi 3 ngÃ y hoáº·c 7 ngÃ y khÃ´ng ghi chi tiÃªu",
    budgetWarning: "Cáº£nh bÃ¡o ngÃ¢n sÃ¡ch",
    budgetWarningDesc: "ThÃ´ng bÃ¡o khi Ä‘áº¡t 70%, 90%, 100% ngÃ¢n sÃ¡ch danh má»¥c",
    weeklyReport: "BÃ¡o cÃ¡o tuáº§n",
    enableReport: "Báº­t bÃ¡o cÃ¡o",
    weeklyReportDesc: "Gá»­i Chá»§ nháº­t 20:00 náº¿u chi tiÃªu thay Ä‘á»•i â‰¥10%",
    selectTime: "Chá»n thá»i gian",
    hour: "Giá»",
    minute: "PhÃºt",
    confirm: "XÃ¡c nháº­n",
    updated: "ÄÃ£ cáº­p nháº­t",
    dailyReminderUpdated: "Nháº¯c nhá»Ÿ hÃ ng ngÃ y sáº½ gá»­i lÃºc {time}",
    // Export/Import
    exportTransactions: "Xuáº¥t giao dá»‹ch",
    importTransactions: "Nháº­p giao dá»‹ch",
    pleaseSelectCSV: "Vui lÃ²ng chá»n file CSV",
    pleaseLoginToImport: "Vui lÃ²ng Ä‘Äƒng nháº­p Ä‘á»ƒ nháº­p dá»¯ liá»‡u",
    importedSuccess: "ÄÃ£ nháº­p {count} giao dá»‹ch thÃ nh cÃ´ng",
    skippedTransactions: " ({skipped} bá» qua)",
    cannotImportCSV: "KhÃ´ng thá»ƒ nháº­p file CSV",
    loading: "Äang táº£i...",
    noCategories: "ChÆ°a cÃ³ danh má»¥c nÃ o",
    // Time periods
    day: "NgÃ y",
    week: "Tuáº§n",
    month: "ThÃ¡ng",
    year: "NÄƒm",
    dateRange: "Khoáº£ng thá»i gian",
    inPeriod: "Trong ká»³",
    // Transactions
    transaction: "Giao dá»‹ch",
    transactionDetail: "Chi tiáº¿t giao dá»‹ch",
    searchTransactions: "TÃ¬m kiáº¿m giao dá»‹ch...",
    filterTransactions: "Lá»c giao dá»‹ch",
    noTransactionsToExport: "KhÃ´ng cÃ³ giao dá»‹ch Ä‘á»ƒ xuáº¥t",
    cannotLoadTransaction: "KhÃ´ng thá»ƒ táº£i giao dá»‹ch",
    cannotSaveTransaction: "KhÃ´ng thá»ƒ lÆ°u giao dá»‹ch",
    cannotDeleteTransaction: "KhÃ´ng thá»ƒ xÃ³a giao dá»‹ch",
    transactionUpdated: "ÄÃ£ cáº­p nháº­t giao dá»‹ch",
    transactionAdded: "ÄÃ£ thÃªm giao dá»‹ch",
    transactionDeleted: "ÄÃ£ xÃ³a giao dá»‹ch",
    confirmDeleteTransaction: "Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n xÃ³a giao dá»‹ch nÃ y?",

    all: "Táº¥t cáº£",
    allCategories: "Táº¥t cáº£ danh má»¥c",
    // Assets
    totalAssets: "Tá»•ng tÃ i sáº£n",
    // CSV Export
    csvAmount: "Sá»‘ tiá»n",
    csvType: "Loáº¡i",
    csvCategory: "Danh má»¥c",
    csvNote: "Ghi chÃº",
    csvDate: "NgÃ y",
    // Budget
    incomeAfterTax: "Thu nháº­p (sau thuáº¿)",
    enterValidIncome: "Vui lÃ²ng nháº­p thu nháº­p há»£p lá»‡",
    analyzingTransactionHistory: "Äang phÃ¢n tÃ­ch lá»‹ch sá»­ giao dá»‹ch...",
    transactionsAnalyzed: "giao dá»‹ch. Báº¡n cÃ³ thá»ƒ chá»‰nh sá»­a trá»±c tiáº¿p.",
    // Budget Tab
    budgetTab: "NgÃ¢n sÃ¡ch",
    goalsTab: "Má»¥c tiÃªu",
    noBudgets: "ChÆ°a cÃ³ ngÃ¢n sÃ¡ch",
    noGoals: "ChÆ°a cÃ³ má»¥c tiÃªu",
    noBudgetsDesc: "Táº¡o káº¿ hoáº¡ch chi tiÃªu thÃ´ng minh vá»›i quy táº¯c 50/30/20",
    noGoalsDesc: "Äáº·t má»¥c tiÃªu tÃ i chÃ­nh vÃ  theo dÃµi tiáº¿n Ä‘á»™",
    createBudget: "Táº¡o ngÃ¢n sÃ¡ch",
    createGoal: "Táº¡o má»¥c tiÃªu",
    budgetOverview: "Tá»•ng quan ngÃ¢n sÃ¡ch",
    totalBudget: "Tá»•ng ngÃ¢n sÃ¡ch",
    spent: "ÄÃ£ chi",
    remaining: "CÃ²n láº¡i",
    searchBudgets: "TÃ¬m kiáº¿m ngÃ¢n sÃ¡ch...",
    smartRecommendations: "Gá»£i Ã½ thÃ´ng minh",
    recommendationHigh:
      "âš ï¸ Báº¡n Ä‘Ã£ chi gáº§n háº¿t ngÃ¢n sÃ¡ch! HÃ£y cÃ¢n nháº¯c giáº£m chi tiÃªu hoáº·c Ä‘iá»u chá»‰nh káº¿ hoáº¡ch.",
    recommendationMedium:
      "ðŸ“Š Báº¡n Ä‘Ã£ chi {percent}% ngÃ¢n sÃ¡ch. HÃ£y theo dÃµi cháº·t cháº½ cÃ¡c khoáº£n chi tiÃªu.",
    budgetExceeded: "âš ï¸ VÆ°á»£t quÃ¡ {percent}% ngÃ¢n sÃ¡ch",
    budgetsList: "Danh sÃ¡ch ngÃ¢n sÃ¡ch",
    showingPlans: "Hiá»ƒn thá»‹ {shown} / {total} káº¿ hoáº¡ch",
    noBudgetsFound: "KhÃ´ng tÃ¬m tháº¥y ngÃ¢n sÃ¡ch",
    tryAdjustFilter: "Thá»­ thay Ä‘á»•i bá»™ lá»c hoáº·c tá»« khÃ³a tÃ¬m kiáº¿m",
    featureInDevelopment: "Chá»©c nÄƒng Ä‘ang phÃ¡t triá»ƒn",
    goalsTabDesc:
      "Tab Má»¥c tiÃªu sáº½ hiá»ƒn thá»‹ danh sÃ¡ch má»¥c tiÃªu tÃ i chÃ­nh cá»§a báº¡n",
    deleteBudgetTitle: "XÃ³a ngÃ¢n sÃ¡ch",
    confirmDeleteBudget: 'Báº¡n cÃ³ cháº¯c muá»‘n xÃ³a "{name}"?',
    cannotDeleteBudget: "KhÃ´ng thá»ƒ xÃ³a ngÃ¢n sÃ¡ch",
    active: "Äang dÃ¹ng",
    fromTo: "Tá»« {start} Ä‘áº¿n {end}",
    from: "Tá»« {start}",
    daily: "HÃ ng ngÃ y",
    weekly: "HÃ ng tuáº§n",
    monthly: "HÃ ng thÃ¡ng",
  },
  en: {
    chatboxAI: "ChatboxAI",
    manualTransaction: "Manual transaction",
    language: "Language",
    accountSettings: "Account Settings",
    walletAndCategories: "Wallet & Categories",
    walletAndCategories_desc: "Categories, Biometric Unlock",
    accountSettings_desc: "Language, Export/Import CSV",
    home: "Home",
    transactions: "Transactions",
    budget: "Budget",
    setting: "Settings",
    exportImportCSV: "Export / Import CSV",
    exportData: "Export Data",
    importData: "Import Data",
    exportCSVFile: "Export CSV File",
    importCSVFile: "Import CSV File",
    exportDesc: "Export all transactions to a CSV file for backup or analysis",
    importDesc:
      "Import transactions from CSV. File must have columns: ID, Amount, Type, Category, Account, Note, Date",
    warning: "Notice",
    warningImport:
      "Import will append new transactions, existing data is not overwritten.",
    success: "Success",
    error: "Error",
    exportSuccess: "Exported {count} transactions",
    exportFail: "Unable to export CSV file",
    shareFail: "Sharing is not available on this device",
    importFeaturePending: "CSV import feature will arrive in a future version",
    selectLanguage: "Select language",
    infoLanguage: "Language changes apply immediately",
    vietnamese: "Vietnamese",
    english: "English",
    // Notifications
    notifications: "Notifications",
    smartNotifications: "Smart Notifications",
    smartNotificationsDesc: "Configure automatic reminders and alerts",
    noNotifications: "No notifications",
    noNotificationsDesc: "Notifications will appear here",
    // Profile & Settings
    profile: "Profile",
    notLoggedIn: "Not logged in",
    loginNow: "Login now",
    viewProfile: "View profile",
    logout: "Logout",
    logoutConfirm: "Are you sure you want to logout?",
    // Theme
    appearance: "Appearance",
    followSystem: "Follow system (recommended)",
    lightMode: "Light",
    darkMode: "Dark",
    // Chatbox
    back: "Back",
    chatWelcome: "Hello!ðŸ‘‹ Start adding your transactions here!",
    askAmount: "Please tell me the exact amount ðŸ’¬",
    recorded: "Recorded:",
    expense: "Expense",
    income: "Income",
    send: "Send",
    inputPlaceholder: "e.g., milk tea 60k Â· Oct salary 10mâ€¦",
    edit: "Edit",
    delete: "Delete",
    confirmDelete: "Confirm Delete",
    confirmDeleteMsg: "Are you sure you want to delete this transaction?",
    cancel: "Cancel",
    editTransaction: "Edit Transaction",
    amount: "Amount",
    note: "Note",
    category: "Category",
    saveChanges: "Save Changes",
    // Add Transaction
    addTransaction: "Add Transaction",
    expenditure: "Expenditure",
    revenue: "Revenue",
    time: "Time",
    enterAmount: "Enter the amount",
    enterNotes: "Enter notes",
    selectCategory: "Select category",
    save: "Save",
    editCategory: "Edit",
    today: "Today",
    yesterday: "Yesterday",
    thisWeek: "This Week",
    lastWeek: "Last Week",
    thisMonth: "This Month",
    lastMonth: "Last Month",
    customRange: "Custom Range",
    // Wallet & Categories
    walletSettings: "Wallet & Categories",
    walletName: "Wallet Name",
    currency: "Currency",
    selectCurrency: "Select Currency",
    openingBalance: "Opening Balance",
    manageCategories: "Manage Categories",
    biometricUnlock: "Unlock with {type}",
    biometricUnlockDesc: "Require authentication for the app",
    biometricRegister: "Register {type} to protect wallet and categories",
    biometricSuccess: "{type} has been activated",
    biometricFailed: "Failed",
    biometricFailedDesc: "Please authenticate to enable this feature",
    deleteWallet: "Delete Wallet",
    cash: "Cash",
    // Categories
    categories: "Categories",
    addCategory: "Add Category",
    editCategoryTitle: "Edit Category",
    categoryName: "Category Name",
    categoryIcon: "Icon",
    categoryColor: "Color",
    deleteCategory: "Delete Category",
    confirmDeleteCategory: 'Delete category "{name}"?',
    predefinedColors: "Predefined Colors",
    customColor: "Choose Custom Color",
    showMore: "Show More",
    showLess: "Show Less",
    colorPickerUnavailable: "Color picker unavailable",
    selectedColor: "Selected Color",
    applyColor: "Apply This Color",
    enterCategoryName: "Please enter category name",
    cannotSaveCategory: "Cannot save category",
    cannotDeleteCategory: "Cannot delete category",

    // Notification settings
    notificationSettings: "Notification Settings",

    dailyReminder: "Daily Reminder",
    enableReminder: "Enable Reminder",
    reminderDesc: "Remind to log expenses at end of day",
    reminderTime: "Reminder Time",
    reminderTimeDesc: "Choose time to receive daily notifications",
    inactivityWarning: "Inactivity Warning",
    enableWarning: "Enable Warning",
    inactivityWarningDesc: "Remind when no expenses logged for 3 or 7 days",
    budgetWarning: "Budget Warning",
    budgetWarningDesc: "Notify when reaching 70%, 90%, 100% of category budget",
    weeklyReport: "Weekly Report",
    enableReport: "Enable Report",
    weeklyReportDesc: "Send Sunday 8:00 PM if spending changes â‰¥10%",
    selectTime: "Select Time",
    hour: "Hour",
    minute: "Minute",
    confirm: "Confirm",
    updated: "Updated",
    dailyReminderUpdated: "Daily reminder will be sent at {time}",
    // Export/Import
    exportTransactions: "Export Transactions",
    importTransactions: "Import Transactions",
    pleaseSelectCSV: "Please select CSV file",
    pleaseLoginToImport: "Please login to import data",
    importedSuccess: "Successfully imported {count} transactions",
    skippedTransactions: " ({skipped} skipped)",
    cannotImportCSV: "Cannot import CSV file",
    loading: "Loading...",
    noCategories: "No categories yet",
    // Time periods
    day: "Day",
    week: "Week",
    month: "Month",
    year: "Year",
    dateRange: "Date Range",
    inPeriod: "In Period",
    // Transactions
    transaction: "Transaction",
    transactionDetail: "Transaction Detail",
    searchTransactions: "Search transactions...",
    filterTransactions: "Filter Transactions",
    noTransactionsToExport: "No transactions to export",
    cannotLoadTransaction: "Cannot load transaction",
    cannotSaveTransaction: "Cannot save transaction",
    cannotDeleteTransaction: "Cannot delete transaction",
    transactionUpdated: "Transaction updated",
    transactionAdded: "Transaction added",
    transactionDeleted: "Transaction deleted",
    confirmDeleteTransaction:
      "Are you sure you want to delete this transaction?",

    all: "All",
    allCategories: "All Categories",
    // Assets
    totalAssets: "Total Assets",
    // CSV Export
    csvAmount: "Amount",
    csvType: "Type",
    csvCategory: "Category",
    csvNote: "Note",
    csvDate: "Date",
    // Budget
    incomeAfterTax: "Income (After Tax)",
    enterValidIncome: "Please enter valid income",
    analyzingTransactionHistory: "Analyzing transaction history...",
    transactionsAnalyzed: "transactions. You can edit directly.",
    // Budget Tab
    budgetTab: "Budget",
    goalsTab: "Goals",
    noBudgets: "No budgets yet",
    noGoals: "No goals yet",
    noBudgetsDesc: "Create a smart spending plan with the 50/30/20 rule",
    noGoalsDesc: "Set financial goals and track progress",
    createBudget: "Create Budget",
    createGoal: "Create Goal",
    budgetOverview: "Budget Overview",
    totalBudget: "Total Budget",
    spent: "Spent",
    remaining: "Remaining",
    searchBudgets: "Search budgets...",
    smartRecommendations: "Smart Recommendations",
    recommendationHigh:
      "âš ï¸ You're close to your budget! Consider reducing spending or adjusting your plan.",
    recommendationMedium:
      "ðŸ“Š You've spent {percent}% of your budget. Keep a closer eye on your expenses.",
    budgetExceeded: "âš ï¸ Exceeded {percent}% of budget",
    budgetsList: "Budgets",
    showingPlans: "Showing {shown} / {total} plans",
    noBudgetsFound: "No budgets found",
    tryAdjustFilter: "Try adjusting filters or search keywords",
    featureInDevelopment: "Feature in development",
    goalsTabDesc: "The Goals tab will show your financial goals list",
    deleteBudgetTitle: "Delete Budget",
    confirmDeleteBudget: 'Are you sure you want to delete "{name}"?',
    cannotDeleteBudget: "Unable to delete budget",
    active: "Active",
    fromTo: "From {start} to {end}",
    from: "From {start}",
    daily: "Daily",
    weekly: "Weekly",
    monthly: "Monthly",
    // Notifications
    notification: "Notification",
    markAllRead: "Mark all as read",
    deleteAllNotifications: "Delete all notifications",
    // Months
    month1: "January",
    month2: "February",
    month3: "March",
    month4: "April",
    month5: "May",
    month6: "June",
    month7: "July",
    month8: "August",
    month9: "September",
    month10: "October",
    month11: "November",
    month12: "December",
    // Weekdays short
    sun: "Sun",
    mon: "Mon",
    tue: "Tue",
    wed: "Wed",
    thu: "Thu",
    fri: "Fri",
    sat: "Sat",
  },
};

interface I18nContextValue {
  lang: SupportedLang;
  setLanguage: (l: SupportedLang) => void;
  t: (key: string, vars?: Record<string, string | number>) => string;
}

const I18nContext = createContext<I18nContextValue>({
  lang: "vi",
  setLanguage: () => {},
  t: (k) => k,
});

export const I18nProvider: React.FC<{ children: React.ReactNode }> = ({
  children,
}) => {
  const [lang, setLang] = useState<SupportedLang>("vi");

  useEffect(() => {
    AsyncStorage.getItem("@app-language").then((stored) => {
      if (stored === "vi" || stored === "en") setLang(stored);
    });
  }, []);

  const setLanguage = (l: SupportedLang) => {
    setLang(l);
    AsyncStorage.setItem("@app-language", l).catch(() => {});
  };

  const t = useMemo(() => {
    return (key: string, vars?: Record<string, string | number>) => {
      const table = translations[lang] || translations.vi;
      let value = table[key] || key;
      if (vars) {
        Object.entries(vars).forEach(([k, v]) => {
          value = value.replace(`{${k}}`, String(v));
        });
      }
      return value;
    };
  }, [lang]);

  const ctx = useMemo(() => ({ lang, setLanguage, t }), [lang, t]);

  return <I18nContext.Provider value={ctx}>{children}</I18nContext.Provider>;
};

export const useI18n = () => useContext(I18nContext);
